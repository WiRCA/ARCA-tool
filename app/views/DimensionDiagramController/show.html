<!--
  ~ Copyright (C) 2011 by Eero Laukkanen, Risto Virtanen, Jussi Patana, Juha Viljanen, Joona Koistinen, Pekka Rihtniemi, Mika KekÃ¤le, Roope Hovi, Mikko Valjus
  ~
  ~ Permission is hereby granted, free of charge, to any person obtaining a copy
  ~ of this software and associated documentation files (the "Software"), to deal
  ~ in the Software without restriction, including without limitation the rights
  ~ to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  ~ copies of the Software, and to permit persons to whom the Software is
  ~ furnished to do so, subject to the following conditions:
  ~
  ~ The above copyright notice and this permission notice shall be included in
  ~ all copies or substantial portions of the Software.
  ~
  ~ THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  ~ IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  ~ FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  ~ AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  ~ LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  ~ OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  ~ THE SOFTWARE.
  -->
<!DOCTYPE html>

<html>
    <head>
        <title>&{'showRCACase.title', rcaCase.caseName}</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta charset="${_response_encoding}">
        #{press.stylesheet 'main.css' /}
        #{press.stylesheet 'jquery-ui-1.8.16.custom.css' /}
        #{press.stylesheet 'base.css' /}
        #{press.stylesheet src:'bootstrap.min.css', compressed:false /}
        #{press.stylesheet 'arcaeditor.css' /}
        #{press.compressed-stylesheet /}

        <link rel="shortcut icon" type="image/png" href="@{'/public/images/favicon.png'}">
        <!--[if lt IE 9]>
        <script src="${'/public/javascripts/excanvas.compiled.js'}" type="text/javascript"></script>
        <![endif]-->
        #{press.script src:'jquery-1.7.1.min.js', compress:false /}
        #{press.script 'bootstrap-twipsy.js' /}
        #{press.script 'bootstrap-popover.js' /}
        #{press.script src:'jquery-ui-1.8.16.custom.min.js', compress:false /}
        #{press.script src:'jquery.tagsinput.js', compress:false /}
        #{press.script 'smalljit.js' /}
        #{press.script 'dimension-diagram.js' /}
        #{press.compressed-script /}

        <script type="text/javascript">
            // Google Analytics
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-28831715-1']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </head>

    <body>
        #{navigation /}

        <div id="dimensionHelp">
            &{'dimensionDiagram.help'} <a href="@{PublicRCACaseController.show(rcaCase.URLHash)}">&{'dimensionDiagram.back'}</a>
        </div>

        <div id="graph"></div>

        <script type="text/javascript">
window.arca = {
    rcaCaseId: ${rcaCase.id},
    rootNode: {
        id: 0,
        name: "${rcaCase.problem.name}"
    },
    classifications: {
    #{list rcaCase.getClassifications(), as:'classification'}
        ${classification.id}: {
            id: ${classification.id},
            title: "${classification.name.escapeJavaScript().raw()}",
            dimension: ${classification.classificationDimension},
            abbreviation: "${classification.abbreviation.escapeJavaScript().raw()}",
            explanation: "${classification.explanation.escapeJavaScript().raw()}",
            relevance: ${classificationRelevance.get(classification.id) ?: 0}
        }${classification_isLast ? '' : ','}
    #{/list}
    },
    relationMap: ${relations.toJson().raw()}
};
        </script>
    </body>
</html>